# 手順書作成ガイドライン

準拠手順書形式：v2.1.1

## はじめに

このガイドラインは、自動解析・デプロイシステム用の手順書フォーマットを説明します。このフォーマットに従って作成された手順書は、Python スクリプト（v2.1.0）によって自動的に解析され、必要なファイルの作成・更新・削除が行われます。

## 手順書の基本構造

手順書は以下の必須セクションを含む必要があります：

1. タイトル
2. 準拠形式バージョン
3. 概要
4. アプリ実行コマンド
5. 必要ファイル一覧
6. ファイルの中身
7. 備考

## フォーマットの詳細ルール

### タイトル
- `# アプリケーション名` 形式で記述する
- 例: `# 開状保復s`

### 準拠形式バージョン
- タイトルの直後に `準拠手順書形式：vX.Y.Z` 形式で記述する
- 例: `準拠手順書形式：v2.1.0`

### 概要
- `## 概要` の見出しに続けて記述
- アプリケーションの概要を10行程度で説明

### アプリ実行コマンド
- `## アプリ実行コマンド` の見出しに続けて、Bash コードブロックで実行コマンドを記述
```bash
cd アプリディレクトリ
コマンド1
コマンド2
```

### 必要ファイル一覧
- `## 必要ファイル一覧` の見出しに続けて記述
- 各行は `アクション,ファイル管理番号,ファイルパス` の形式
- アクションは「新規」「修正」「削除」のいずれか
- ファイル管理番号は5桁の数字（00000～99999）
- ファイルパスは拡張子を含む相対パス
- 2回目以降の手順書では、変更のないファイルは記載不要
- 例:
```
新規,00000,Program.cs
修正,00001,Models/User.cs
削除,00002,OldFile.txt
```

### ファイルの中身
- 各ファイルの内容は `### アクション,ファイル管理番号,ファイルパス` の見出しに続けて記述
- コミットメッセージを `コミット内容：メッセージ` の形式で記述（任意）
- その後、適切な言語のコードブロックでファイルの内容を記述
- コード内では、コード管理番号 `#00001_abcde` のように5桁の数字と5文字のランダム英小文字を組み合わせた形式で管理番号をコメントアウトとして付与する
- コード管理番号はファイル内で連番かつ一意である必要がある
- コメント内の追加説明は「メモ：」の後に記述する
- すべてのスクリプトファイルの最後には必ず終点マークとして `#99999_zzzzz` をコメントアウトとして記述する

#### 新規ファイルの場合
```
### 新規,00000,index.js
コミット内容：プログラムエントリポイントを作成
```javascript
// #00003_klmno
// ルーターの作成
const router = createRouter({
  history: createWebHistory(process.env.BASE_URL),
  routes,
  scrollBehavior() {
    // ページ遷移時に先頭にスクロール
    return { top: 0 }
  }
})

// #99999_zzzzz
```

#### 修正ファイルの場合
- 修正内容は「#### #修正開始コード番号-#修正完了コード番号」の見出しで指定
- 一つのファイル内に複数の修正箇所がある場合は、複数の修正セクションを記述
- 修正セクションの内容は、指定された範囲を完全に置き換える

```
### 修正,00001,Models/User.cs
コミット内容：ユーザーモデルにプロパティを追加

#### #00002_fghij-#00003_klmno
```csharp
    // #00002_fghij
    public class User
    {
        // #00003_klmno
        public int Id { get; set; }
        public string Name { get; set; }
        public string Email { get; set; }
        public DateTime CreatedAt { get; set; }
```

#### #00005_pqrst-#00006_uvwxy
```csharp
        // #00005_pqrst
        public bool IsActive { get; set; }

        // #00006_uvwxy
        public User()
        {
            CreatedAt = DateTime.Now;
            IsActive = true;
        }
```

### 備考
- `## 備考` の見出しに続けて記述
- ファイルの説明や開発上の注意点などを記述

## インデントに関する重要な注意

修正する際は必ずインデントに気をつけてください。元のインデントに合わせて関数の途中のみの修正であっても元のインデントを踏襲し、修正するコード管理番号から次のコード管理番号手前までの部分でまとめて置き換えるのでよくよく注意してください。

## コード管理番号の形式について（v2.0.0での変更点）

v2.0.0から、コード管理番号は以下の形式に変更されました：

1. `#00001_abcde` のように、5桁の数字と5文字のランダム英小文字を組み合わせた形式を使用
2. スクリプトファイルの最後には必ず終点マークとして `#99999_zzzzz` をコメントアウトとして追加する

この変更により：
- 様々な言語が混在するファイル（PHPファイル内のHTMLなど）でも確実にコード管理番号を検出できる
- 言語やコメント記法に依存しない一貫した形式で管理番号を指定できる

## よくあるファイルのコメントアウト（v2.1.0で追加）

様々なファイル形式でコード管理番号を適切に記述するため、以下に主要なファイル形式ごとのコメントアウト方法を示します。コード管理番号は常に単一行で記述し、行の先頭に配置するか適切なコメント記法内に含めてください。

| ファイル形式 | 拡張子 | コメント記法 | コード管理番号例 |
|------------|------|------------|---------------|
| HTML       | .html, .htm | <!-- コメント --> | <!-- #00001_abcde --> |
| PHP (PHPコード部分) | .php | // コメント または /* コメント */ | // #00001_abcde |
| PHP (HTML部分) | .php | <!-- コメント --> | <!-- #00001_abcde --> |
| JavaScript | .js  | // コメント または /* コメント */ | // #00001_abcde |
| CSS        | .css | /* コメント */ | /* #00001_abcde */ |
| Python     | .py  | # コメント | # #00001_abcde |
| Java       | .java | // コメント または /* コメント */ | // #00001_abcde |
| C#         | .cs  | // コメント または /* コメント */ | // #00001_abcde |
| Ruby       | .rb  | # コメント | # #00001_abcde |
| Shell      | .sh  | # コメント | # #00001_abcde |
| XML        | .xml | <!-- コメント --> | <!-- #00001_abcde --> |

### 注意事項
1. コード管理番号は必ず一行で記述してください（複数行に渡るコード管理番号は対応していません）
2. 最初のコード管理番号は行の先頭にコメントアウトとして記述してください
3. PHPファイルのようにHTMLとスクリプトが混在するファイルでは、それぞれの言語に適したコメント方法を使用してください
4. すべてのファイルの最後には終点マークとして `#99999_zzzzz` を必ずコメントアウトとして記述してください

## 手順書テンプレート

```markdown
# アプリケーション名

準拠手順書形式：v2.1.0

## 概要
アプリケーションの概要を10行程度で説明します。
機能や目的、使用技術などを簡潔に記述してください。

## アプリ実行コマンド
\```bash
cd アプリディレクトリ
コマンド1
コマンド2
\```

## 必要ファイル一覧
新規,00000,ファイル1.拡張子
新規,00001,ディレクトリ/ファイル2.拡張子
修正,00002,既存ファイル.拡張子
削除,00003,不要ファイル.拡張子

## ファイルの中身

### 新規,00000,ファイル1.拡張子
コミット内容：ファイル1の作成目的
\```適切な言語
# #00001_abcde
ファイルの内容をここに記述

# #00002_fghij
さらにコード

// メモ：必要に応じてメモを残す

# #99999_zzzzz
\```

### 新規,00001,ディレクトリ/ファイル2.拡張子
コミット内容：ファイル2の作成目的
\```適切な言語
// #00001_klmno
ファイルの内容をここに記述

// #99999_zzzzz
\```

### 修正,00002,既存ファイル.拡張子
コミット内容：既存ファイルの修正内容

#### #00003_pqrst-#00004_uvwxy
\```適切な言語
    // #00003_pqrst
    修正後のコード
    
    // #00004_uvwxy
    さらに修正後のコード
\```

## 備考
1. 開発上の注意点をここに記述します。
2. ファイルの詳細な説明や依存関係についても記述できます。
3. その他、手順書だけでは伝わらない情報をここに記述します。
```
※なお、上記のサンプルコードでスクリプトの部分は\（バックスラッシュ）で記載していますが、このガイドライン自体がmd形式のためにエスケープしているため、実際に手順書を作る際は付けないでください。

## 注意事項

1. コード管理番号（`#00001_abcde`～）はファイル内で連番かつ一意である必要があり、コメント記法に基づいて記載してください
2. コード管理番号は同じファイル内で他のコード番号と重複してはいけません
3. コード管理番号は常に行の先頭に記述してください
4. ファイルには最低1つのコード管理番号を付与してください
5. スクリプトファイルの最後には必ず終点マークとして `#99999_zzzzz` をコメントアウトとして記述してください
6. コミットメッセージは必須ではありませんが、記述を推奨します
7. 修正範囲を指定する際は、開始コード番号と終了コード番号の間のすべてのコードが置き換えられます
8. 2回目以降の手順書では、変更のないファイルは記載しないでください
9. JSONに関してはコード管理番号を付けなくていいです

このフォーマットに従って手順書を作成することで、Python スクリプト v2.1.0 による自動解析・デプロイが正常に機能します。
